<!DOCTYPE html>
<html>
  <head>
    <meta charaset="UTF-8" />
    <link
      rel="stylesheet"
      href="https://unpkg.com/element-ui/lib/theme-chalk/index.css"
    />
    <title>Make10</title>
  </head>

  <body>
    <div id="app">
      <h1 class="target">
        make
        <el-input-number
          class="sum"
          type="number"
          v-model="target"
          @change="changeNum"
          controls-position="right"
        ></el-input-number>
      </h1>

      <div class="args">
        <div
          class="argInput"
          v-for="i in numArgs"
          style="display:inline-block;"
        >
          <el-input-number
            v-model="args[i-1]"
            @change="changeNum"
            controls-position="right"
          ></el-input-number>
        </div>
      </div>

      <div class="answers">
        <div v-for="formula in formulas ">
          {{ formula }}
        </div>
      </div>
    </div>
  </body>
</html>

<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://unpkg.com/element-ui/lib/index.js"></script>

<script>
  const app = new Vue({
    el: "#app",
    data: {
      target: "10",
      numArgs: 4,
      args: [],
      formulas: ["NA"]
    },
    created: function() {
      this.setDate();
      this.changeNum();
    },
    methods: {
      setDate: function() {
        let now = new Date();
        let month = now.getMonth() + 1; //月 1月=0なのでインクリメント
        let day = now.getDate(); //日
        this.args = [
          Math.floor(month / 10).toFixed(),
          (month % 10).toFixed(),
          Math.floor(day / 10).toFixed(),
          (day % 10).toFixed()
        ];
      },
      changeNum: function() {
        var bracketsPatterns = [
          "((a?b)!c)@d",
          "(a?b)!(c@d)",
          "(a?(b!c))@d",
          "a?((b!c)@d)",
          "a?(b!(c@d))"
        ];
        const opPlaceChar = ["?", "!", "@"];
        const operators = ["+", "-", "*", "/"];

        // 式の生成

        var formulaPatterns = bracketsPatterns;
        for (let i = 0; i < opPlaceChar.length; i++) {
          const opc = opPlaceChar[i];
          var _formulaPatterns = [];
          formulaPatterns.map(bp =>
            operators.map(op => _formulaPatterns.push(bp.replace(opc, op)))
          );
          formulaPatterns = _formulaPatterns;
        }

        let formulas = [];

        formulaPatterns.map(fp => {
          let f = fp;
          f = f
            .replace("a", this.args[0])
            .replace("b", this.args[1])
            .replace("c", this.args[2])
            .replace("d", this.args[3]);

          console.log(f);
          let ans = 0;
          eval("ans = " + f);
          if (ans == this.target) {
            formulas.push(this.target + " = " + f);
          }
        });

        if (formulas.length === 0) {
          this.formulas = ["NA"];
        } else {
          this.formulas = formulas;
        }
      }
    }
  });
</script>
